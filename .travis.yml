branches:
  only:
  - master
  - "/^greenkeeper/.*$/"
  except:
  - "/^v\\d+\\.\\d+\\.\\d+$/"
language: node_js
node_js:
- 14.2.0
cache:
  directories:
  - "~/.npm"
  - ".jest"
jobs:
  include:
  - stage: test
    if: commit_message !~ /(travis-deploy)/
    script:
    - yarn test:ci
  - stage: release
    if: branch = master AND (NOT type = pull_request) AND (commit_message !~ /(travis-deploy)/)
    script:
    - yarn semantic-release
  - stage: deploy
    if: branch = master AND (NOT type = pull_request) AND (commit_message =~ /(travis-deploy)/)
    deploy:
      provider: heroku
      app: express-ts-starter
      api_key:
        secure: BjZpcsQBm7Y4NJOfif+b9YzrLRKpYojVPtVMxZzRy8AZWqRNvfJi/WyEgkWYVzS2jWknkjaCEcmRCdrViPnJos/v9wOOMFX0atmVlFOHHw9s6HSHcC7lufv+mjiCg/DM0CEqqKDNaqmh/OblvD4tQfi82tMUYiYayTwvUywNpY/bgVCN0E2t0lxGVxYKIKuZoSH4x5MzbhCbwK/gD5VUKJINQ/2Wb7GUnlofTPEIo/m9TGksKHAR+c4SmKbIBSrxXzO8hFMUcYvueWSBtOKozkgp8eiKoxeGXkRmyRcF35Ys8/S7RU1VCLbah5iO/i3h+A9ZvLzVOkJhHEMWhXamiEyVGkEvc4uVlw/q4mwoGFkMLsc44RwFiCLt7yF2E7nTObZKTt5ynfw0lPzCiMY06K5gterfspi30GZ8e87cdpuw8efJJ7cjaeZFLdYBEhuMVC6qJ6i+Ye6L62eFZb26z8s7U6AwG/+u3S/lx7iKY2IHsLLqgK2ajjK8RAPK6zyP8DgcyhAdx3cPuvi1xQSYXMw2cCuuWALBOPFfNokP22wxx/nvqCwnziYG9vmo3lVlEYfTcHDqotJrBKPMuPCD6bt60jbtarGuwAKCgO5tXVh2EKA3YdaUKtHqntcLfsVj0RiOdwsOdfiLY+lehPEQapsle3Cvoc4G0gp6lnLhIBs=
